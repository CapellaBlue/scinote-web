<% provide(:head_title, raw(t("my_modules.protocols.head_title", project: @project.name, module: @my_module.name))) %>
<%= render partial: "shared/sidebar" %>
<%#= render partial: "shared/secondary_navigation" %>

<% @widget = true %>

<%#= render partial: "module_header" %>

<div data-role="protocol-status-bar" style="display: inline;">
	<div class="panel panel-default panel-protocol-status">
	  <div class="panel-body">
	    <% if @protocol.linked? %>
	      <%= protocol_name(@protocol.parent) %>
	    <% else %>
	      <%= t("my_modules.protocols.protocol_status_bar.unlinked") %>
	    <% end %>
	    &nbsp;
		<div class="btn-group">
		  <% if @protocol.unlinked? or @protocol.linked_no_diff? %>
		    <a type="button" class="btn btn-info" disabled="disabled">
		      <span class="glyphicon glyphicon-book"></span>
		      &nbsp;
		      <% if @protocol.unlinked? then %>
		      	<span class="glyphicon glyphicon-remove-sign"></span>
		      <% elsif @protocol.linked_no_diff? %>
		      	<span class="glyphicon glyphicon-ok-sign"></span>
		      <% end %>
		    </a>
		    <a type="button" class="btn btn-info dropdown-toggle" disabled="disabled">
		      <span class="caret"></span>
		    </a>
		  <% else %>
			<a type="button" class="btn btn-warning" disabled="disabled">
			  <span class="glyphicon glyphicon-book"></span>
			  &nbsp;
			  <% if @protocol.newer_than_parent? %>
			    <span class="glyphicon glyphicon-circle-arrow-down"></span>
			  <% elsif @protocol.parent_newer? %>
				<span class="glyphicon glyphicon-circle-arrow-up"></span>
			  <% elsif @protocol.parent_and_self_newer? %>
			    <span class="glyphicon glyphicon-exclamation-sign"></span>
			  <% end %>
			</a>
			<a type="button" class="btn btn-warning dropdown-toggle" disabled="disabled">
			  <span class="caret"></span>
			</a>
		  <% end %>
		</div>
	  </div>
	</div>
	<%= javascript_include_tag("my_modules/protocols/protocol_status_bar") %>
</div>

<div data-role="steps-container">
  <%= render partial: "protocols/steps.html.erb" %>
</div>

<!-- Tutorial data -->
<div class="hidden" data-role="tutorial-data" data-module-id="<%= @my_module.id %>"
  data-module-protocols-step-text="<%=t 'tutorial.module_protocols_html' %>"
  data-module-protocols-click-results-step-text="<%=t 'tutorial.module_protocols_click_results_html' %>">
</div>

<!-- URL for status bar refreshing -->
<div class="hidden" data-role="protocol-status-bar-url" data-url="<%= protocol_status_bar_protocol_path(@protocol) %>"></div>

<!-- Edit description modal -->
<%= render partial: "my_modules/modals/manage_description_modal" %>

<!-- Edit due date modal -->
<%= render partial: "my_modules/modals/manage_due_date_modal" %>

<!-- Confirm link update modal -->
<%= render partial: "my_modules/protocols/confirm_link_update_modal.html.erb" %>

<!-- Load from repository modal -->
<%= render partial: "my_modules/protocols/load_from_repository_modal.html.erb" %>

<!-- Copy to repository protocol modal -->
<%= render partial: "my_modules/protocols/copy_to_repository_modal.html.erb" %>

<!-- Import protocol elements -->
<%= render partial: "protocols/import_export/import_elements.html.erb" %>

<%= stylesheet_link_tag 'datatables' %>
<%= javascript_include_tag("my_modules/protocols") %>
